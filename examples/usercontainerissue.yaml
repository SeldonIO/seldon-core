apiVersion: machinelearning.seldon.io/v1alpha2
kind: SeldonDeployment
metadata:
  labels:
    app: seldon
  name: mlflow-binary-no-orchestrator
spec:
  #annotations:
  #  seldon.io/headless-svc: "true"
  name: mlflow-binary-no-orchestrator
  predictors:
    - annotations:
        seldon.io/no-engine: "true"
      componentSpecs:
        - spec:
            containers:
              - image: seldonio/tf-example-mnist:0.1
                imagePullPolicy: IfNotPresent
                name: mlflow-prehac-artifact-model
                resources:
                  limits:
                    cpu: 1
                    memory: 2Gi
                  requests:
                    cpu: 1
                    memory: 256Mi
              - image: seldonio/tf-example-mnist:0.1
                imagePullPolicy: IfNotPresent
                name: output-transformer
                resources:
                  limits:
                    cpu: 1
                    memory: 2Gi
                  requests:
                    cpu: 1
                    memory: 256Mi

      svcOrchSpec:
        env:
          - name: JAVA_OPTS
            value: -server -Xms512m -Xmx512m -XX:+AlwaysPreTouch -XX:+UnlockExperimentalVMOptions -XX:G1NewSizePercent=20 -XX:+UseG1GC -XX:MaxGCPauseMillis=10 -XX:GCLogFileSize=10485760 -XX:NumberOfGCLogFiles=1 -XX:+PrintGC -XX:+PrintGCApplicationStoppedTime -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintTenuringDistribution -XX:+UseGCLogFileRotation -Xloggc:/tmp/gc.log -XX:+UseTLAB -XX:+DisableExplicitGC
          - name: SELDON_LOG_LEVEL
            value: DEBUG

        resources:
          limits:
            cpu: 2
            memory: 4Gi
          requests:
            cpu: 500m
            memory: 1Gi
      #graph:
      #  children: []
      #  endpoint:
      #    type: GRPC
      #  name: mlflow-prehac-artifact-model
      #  type: MODEL
      #name: artifact

      graph:

        children: []

        name: mlflow-prehac-artifact-model
        endpoint:
          type: REST
        type: MODEL
      name: artifact

      replicas: 1