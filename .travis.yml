sudo: required
services:
- docker
branches:
  only:
  - master
  - travis-update
jobs:
  include:
  - stage: build-components
    script:
    - echo Building api-frontend
    - |
      set -x && \
      docker run --rm -it \
          -v /var/run/docker.sock:/var/run/docker.sock \
          -v ${HOME}/.m2:/root/.m2 \
          -v $(pwd):/work \
          seldonio/core-builder:0.1 bash -c 'cd api-frontend && make -f Makefile.ci build'
    - docker images | grep 'seldonio/apife'
  - script:
    - echo Building engine
    - |
      set -x && \
      docker run --rm -it \
          -v /var/run/docker.sock:/var/run/docker.sock \
          -v ${HOME}/.m2:/root/.m2 \
          -v $(pwd):/work \
          seldonio/core-builder:0.1 bash -c 'cd engine && make -f Makefile.ci build'
    - docker images | grep 'seldonio/engine'

notifications:
  slack:
    secure: W5Ge33YGs4/vUBJxkaKVyt2fzDXuo626utrKs2dV4RQggC5/Yg0THdsDizN6gPnQBA2+P0aFqAuWEx2MPhQvf8BUnP+8v+htD9Y5stLvcdRQaPOh8Hv9vuHBHitwhOllnHPq2HX7VRXA/nSA8Vbj9MJhOManDH7Esr7ebrXyYXOahCsNBgufO03Wg+r3f6yl7gBviEq3+wEAyB8a8BHN+WgDATtz50XbSo8MZL1QdWDzg+dg1ImwUJy5WLNlxMihLgiI5FnW6jWhkZzh7pB6JNoMn+kraHBMyJH39Lpb4Qnu9PS5x7rIpEUST5z48qa1BtUeyQpq/mw+OHu24MbPqy286ZQfpjRtx9NdZ1lR5tRAJNgtBOoVWy4spJJwNEyFbdz1bJut2zXmh17ekYQT9mc6VlpZ5FdSJrL0MEwT+81zfSdIXyW7tD0nRFKdSFLZW98M++fUMmmvJGqmg2iMyoBqMhcgLTlgiFuj6ncKvQ4hMJHBdrnwgZT6XKX1ivf7smR+xvD+hDoZVOvxMGm5mOD2y1fleY/Slw3iLvldnSy8RlC02tN/00bBHsnKWZ6VdR3xOSyeH/El+KUAqS64D0/3xw7bGdoc9lP7EGobea2IEV+tjQSNw6kXZUnrzVt4V7h/VPeLH/704VQvNY87ArDDZuQmDXHA717MBy0J8mU=

