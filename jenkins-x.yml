buildPack: none
pipelineConfig:
  pipelines:
    pullRequest:
      pipeline:
        agent:
          image: seldonio/core-builder:0.4
        stages:
          - name: end-to-end
            steps:
            - name: test-end-to-end
              command: "./testing/scripts/kind_test_all.sh"
            options:
              containerOptions:
                volumeMounts:
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                - name: dind-storage
                  mountPath: /var/lib/docker
                securityContext:
                  privileged: true
                imagePullPolicy: Always
              volumes:
              - name: modules
                hostpath:
                  path: /lib/modules
                  type: directory
              - name: cgroup
                hostpath:
                  path: /sys/fs/cgroup
                  type: directory
              - name: dind-storage
                emptydir: {}

